<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dash Food - Pedidos Online</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root { --main-red: #ff4757; --main-green: #2ed573; }
        body { background-color: #f8f9fa; font-family: 'Segoe UI', sans-serif; }
        .app-header { background: var(--main-red); color: white; padding: 25px; text-align: center; border-radius: 0 0 30px 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .food-card { border: none; border-radius: 20px; cursor: pointer; transition: 0.3s; background: white; overflow: hidden; }
        .food-card:active { transform: scale(0.95); }
        .food-img { height: 120px; width: 100%; object-fit: cover; }
        .order-box { background: white; border-radius: 25px; padding: 25px; margin-top: -20px; border: none; }
        .btn-send { background: var(--main-green); color: white; border: none; padding: 18px; border-radius: 15px; font-weight: bold; width: 100%; font-size: 1.1rem; }
        .gps-badge { font-size: 0.85rem; padding: 8px; border-radius: 10px; display: inline-block; width: 100%; text-align: center; margin-bottom: 15px; }
    </style>
</head>
<body>

<div class="app-header">
    <h1 class="fw-bold">üçî DASH FOOD</h1>
    <p class="mb-0">Pide ahora, nosotros cocinamos</p>
</div>

<div class="container py-4">
    <h6 class="fw-bold mb-3">1. Elige tu favorito:</h6>
    <div class="row g-3 mb-4">
        <div class="col-6">
            <div class="card food-card shadow-sm" onclick="seleccionar('Hamburguesa Especial - $120')">
                <img src="https://images.unsplash.com/photo-1571091718767-18b5b1457add?w=400" class="food-img">
                <div class="p-2 text-center">
                    <h6 class="mb-0 small fw-bold">Burger Especial</h6>
                    <span class="text-danger small">$120</span>
                </div>
            </div>
        </div>
        <div class="col-6">
            <div class="card food-card shadow-sm" onclick="seleccionar('Pizza Pepperoni - $150')">
                <img src="https://images.unsplash.com/photo-1628840042765-356cda07504e?w=400" class="food-img">
                <div class="p-2 text-center">
                    <h6 class="mb-0 small fw-bold">Pizza Pepperoni</h6>
                    <span class="text-danger small">$150</span>
                </div>
            </div>
        </div>
    </div>

    <div class="card order-box shadow">
        <h5 class="fw-bold mb-3">2. Tu Entrega</h5>
        
        <label class="small text-muted mb-1">Tu selecci√≥n:</label>
        <input type="text" id="input_pedido" class="form-control mb-3 border-0 bg-light" placeholder="Toca una comida arriba" readonly>
        
        <input type="text" id="input_nombre" class="form-control mb-2 p-3 bg-light border-0" placeholder="¬øA nombre de qui√©n?">
        <textarea id="input_dir" class="form-control mb-3 p-3 bg-light border-0" rows="3" placeholder="Calle, n√∫mero, colonia y referencias"></textarea>
        
        <div id="gps-info" class="gps-badge bg-light text-muted">üìç Localizando tu direcci√≥n...</div>
        
        <button onclick="enviarTrello()" id="btn-final" class="btn-send shadow">üöÄ ENVIAR A COCINA</button>
    </div>
</div>

<script>
    // Inicializaci√≥n con tus credenciales
    emailjs.init("Jws9VnXaXadzJN4BN");

    let urlMapa = "No proporcionada";

    // Captura de GPS
    navigator.geolocation.getCurrentPosition(pos => {
        urlMapa = `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
        const badge = document.getElementById('gps-info');
        badge.innerText = "‚úÖ Ubicaci√≥n detectada con √©xito";
        badge.className = "gps-badge bg-success text-white";
    }, () => {
        const badge = document.getElementById('gps-info');
        badge.innerText = "‚ö†Ô∏è Por favor activa el GPS";
        badge.className = "gps-badge bg-warning text-dark";
    });

    function seleccionar(nombre) {
        document.getElementById('input_pedido').value = nombre;
    }

    function enviarTrello() {
        const btn = document.getElementById('btn-final');
        const datos = {
            nombre: document.getElementById('input_nombre').value,
            pedido: document.getElementById('input_pedido').value,
            direccion: document.getElementById('input_dir').value,
            mapa: urlMapa
        };

        // Validaci√≥n simple
        if (!datos.nombre || !datos.pedido || !datos.direccion) {
            alert("Bro, completa todos los campos para poder enviarte la comida.");
            return;
        }

        btn.innerText = "Enviando...";
        btn.disabled = true;

        // Env√≠o usando tus IDs confirmados
        emailjs.send("service_dinv319", "template_36vysdi", datos)
            .then(() => {
                alert("¬°Pedido enviado! üéâ Revisa tu tablero de Trello.");
                location.reload();
            })
            .catch(error => {
                alert("Error al enviar. Revisa que tu Gmail en EmailJS est√© bien conectado.");
                console.error("Error:", error);
                btn.innerText = "üöÄ ENVIAR A COCINA";
                btn.disabled = false;
            });
    }
</script>

</body>
</html>